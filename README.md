# ğŸŒ³ **Model Training â€” MLOps Iris Classifier**

This branch builds upon the **data preparation stage** by introducing the **`model_training.py`** module inside `src/`.
It marks the **second executable workflow stage** of the **MLOps Iris Classifier** pipeline â€” responsible for loading the processed datasets, training a Decision Tree classifier, evaluating performance, and saving the trained model and confusion matrix.

## ğŸ§© **Overview**

The `ModelTraining` class implements a **reproducible model training and evaluation workflow** with integrated logging and exception handling.
It consumes the processed outputs generated by the previous stage (`data_processing.py`) and produces trained model artefacts for downstream evaluation or deployment.

### ğŸ” Core Responsibilities

| Stage | Operation          | Description                                                                               |
| ----: | ------------------ | ----------------------------------------------------------------------------------------- |
|   1ï¸âƒ£ | **Load Data**      | Loads `X_train`, `X_test`, `y_train`, and `y_test` from `artifacts/processed/`.           |
|   2ï¸âƒ£ | **Train Model**    | Trains a `DecisionTreeClassifier` using the Gini criterion with depth limit 30.           |
|   3ï¸âƒ£ | **Evaluate Model** | Computes **accuracy**, **precision**, **recall**, and **F1-score**, logging all metrics.  |
|   4ï¸âƒ£ | **Save Artefacts** | Saves the trained model (`model.pkl`) and a confusion matrix plot to `artifacts/models/`. |

## ğŸ—‚ï¸ **Updated Project Structure**

```text
mlops_iris_classifier/
â”œâ”€â”€ .venv/                          # ğŸ§© Local virtual environment (created by uv)
â”œâ”€â”€ artifacts/
â”‚   â”œâ”€â”€ raw/
â”‚   â”‚   â””â”€â”€ data.csv                # ğŸŒ¸ Input Iris dataset
â”‚   â”œâ”€â”€ processed/                  # ğŸ’¾ Processed data artefacts (from previous stage)
â”‚   â”‚   â”œâ”€â”€ X_train.pkl
â”‚   â”‚   â”œâ”€â”€ X_test.pkl
â”‚   â”‚   â”œâ”€â”€ y_train.pkl
â”‚   â”‚   â””â”€â”€ y_test.pkl
â”‚   â””â”€â”€ models/                     # ğŸ§  Trained model and evaluation artefacts
â”‚       â”œâ”€â”€ model.pkl
â”‚       â””â”€â”€ confusion_matrix.png
â”œâ”€â”€ mlops_iris_classifier.egg-info/ # ğŸ“¦ Package metadata (auto-generated)
â”œâ”€â”€ pipeline/                       # âš™ï¸ Pipeline orchestration (future stage)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ custom_exception.py         # Unified and detailed exception handling
â”‚   â”œâ”€â”€ logger.py                   # Centralised logging configuration
â”‚   â”œâ”€â”€ data_processing.py          # ğŸŒ¸ Data preparation workflow
â”‚   â””â”€â”€ model_training.py           # ğŸŒ³ Model training and evaluation workflow
â”œâ”€â”€ static/                         # ğŸŒ Visual assets (optional)
â”œâ”€â”€ templates/                      # ğŸ§© Placeholder for web/API templates
â”œâ”€â”€ .gitignore                      # ğŸš« Git ignore rules
â”œâ”€â”€ .python-version                 # ğŸ Python version pin
â”œâ”€â”€ pyproject.toml                  # âš™ï¸ Project metadata and uv configuration
â”œâ”€â”€ requirements.txt                # ğŸ“¦ Python dependencies
â”œâ”€â”€ setup.py                        # ğŸ”§ Editable install support
â””â”€â”€ uv.lock                         # ğŸ”’ Locked dependency versions
```

## âš™ï¸ **How to Run the Model Training Module**

Once the preprocessing stage (`python src/data_processing.py`) has completed and artefacts are available under `artifacts/processed/`, execute the following command:

```bash
python src/model_training.py
```

### âœ… **Expected Successful Output**

```console
2025-11-06 23:21:57,338 - INFO - ModelTraining initialised successfully.
2025-11-06 23:21:57,343 - INFO - Processed data loaded successfully.
2025-11-06 23:21:57,348 - INFO - Model trained and saved successfully.
2025-11-06 23:21:57,358 - INFO - Accuracy Score  : 1.0000
2025-11-06 23:21:57,358 - INFO - Precision Score : 1.0000
2025-11-06 23:21:57,359 - INFO - Recall Score    : 1.0000
2025-11-06 23:21:57,359 - INFO - F1 Score        : 1.0000
2025-11-06 23:22:00,399 - INFO - Confusion matrix saved successfully.
```

This confirms that:

* The processed datasets were loaded correctly.
* The Decision Tree model was trained successfully.
* Performance metrics were computed and logged.
* Both the model and confusion matrix were saved to `artifacts/models/`.

## ğŸ§  **Implementation Highlights**

* **Integrated Logging** via `src/logger.py`
  Every key step (data loading, training, evaluation, and saving) is logged with timestamps for full auditability.

* **Unified Exception Handling** via `src/custom_exception.py`
  Any runtime failure (e.g., file loading errors, training exceptions) is captured with descriptive context and tracebacks.

* **Scalable, Modular Design**
  The `ModelTraining` class is modular and ready to extend for new models or hyperparameter tuning in future pipeline iterations.

## ğŸ§© **Integration Guidelines**

| File                      | Purpose                                                        |
| ------------------------- | -------------------------------------------------------------- |
| `src/model_training.py`   | Executes model training and evaluation workflow.               |
| `src/data_processing.py`  | Produces processed datasets required for training.             |
| `src/custom_exception.py` | Ensures uniform error handling and descriptive tracebacks.     |
| `src/logger.py`           | Provides structured, timestamped logging throughout execution. |

âœ… **In summary:**
This branch transforms the Iris pipeline from a preprocessing workflow into a **complete model training stage** â€” delivering a reproducible, logged, and traceable process for model fitting and evaluation.
Run it with `python src/model_training.py` to train the classifier and generate your first model artefacts.